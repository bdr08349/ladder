<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Gatherers - Ladder docs</title>
    <meta name="generator" content="Hugo 0.17" />

    
    <meta name="description" content="A flexible and reliable autoscaler">
    
    <link rel="canonical" href="https://themotion.github.io/ladder/blocks/gatherers/">
    
    <meta name="author" content="TheMotion">
    

    <meta property="og:url" content="https://themotion.github.io/ladder/blocks/gatherers/">
    <meta property="og:title" content="Ladder docs">
    <meta property="og:image" content="https://themotion.github.io/ladder/img/logo.png">
    <meta name="apple-mobile-web-app-title" content="Ladder docs">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://themotion.github.io/ladder/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://themotion.github.io/ladder/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://themotion.github.io/ladder/fonts/icon.eot?52m981');
        src: url('https://themotion.github.io/ladder/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://themotion.github.io/ladder/fonts/icon.woff?52m981')
               format('woff'),
             url('https://themotion.github.io/ladder/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://themotion.github.io/ladder/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://themotion.github.io/ladder/stylesheets/application.css">
    <link rel="stylesheet" href="https://themotion.github.io/ladder/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://themotion.github.io/ladder/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://themotion.github.io/ladder/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://themotion.github.io/ladder/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-deep-purple palette-accent-light-blue">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Gatherers
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/themotionvideo" title="@themotionvideo on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/themotion" title="@themotion on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://github.com/themotion/ladder" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://themotion.github.io/ladder/img/logo.png">
        </div>
      
      <div class="name">
        <strong>Ladder docs <span class="version">0.1.0</span></strong>
        
          <br>
          themotion/ladder
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="https://github.com/themotion/ladder/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/themotion/ladder/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    <span class="section">Introduction</span>
    <ul>
      
        
        



<a  title="Overview" href="https://themotion.github.io/ladder/introduction/overview/">
	
	Overview
</a>



      
        
        



<a  title="Installing" href="https://themotion.github.io/ladder/introduction/installing/">
	
	Installing
</a>



      
        
        



<a  title="Quickstart" href="https://themotion.github.io/ladder/introduction/quickstart/">
	
	Quickstart
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Concepts</span>
    <ul>
      
        
        



<a  title="Autoscaler" href="https://themotion.github.io/ladder/concepts/autoscaler/">
	
	Autoscaler
</a>



      
        
        



<a  title="Blocks" href="https://themotion.github.io/ladder/concepts/blocks/">
	
	Blocks
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Available Blocks</span>
    <ul>
      
        
        



<a  title="Gatherers" href="https://themotion.github.io/ladder/blocks/gatherers/">
	
	Gatherers
</a>



      
        
        



<a  title="Arrangers" href="https://themotion.github.io/ladder/blocks/arrangers/">
	
	Arrangers
</a>



      
        
        



<a  title="Solvers" href="https://themotion.github.io/ladder/blocks/solvers/">
	
	Solvers
</a>



      
        
        



<a  title="Filters" href="https://themotion.github.io/ladder/blocks/filters/">
	
	Filters
</a>



      
        
        



<a  title="Scalers" href="https://themotion.github.io/ladder/blocks/scalers/">
	
	Scalers
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Operating</span>
    <ul>
      
        
        



<a  title="Running" href="https://themotion.github.io/ladder/operating/running/">
	
	Running
</a>



      
        
        



<a  title="Configuration" href="https://themotion.github.io/ladder/operating/configuration/">
	
	Configuration
</a>



      
        
        



<a  title="Metrics" href="https://themotion.github.io/ladder/operating/metrics/">
	
	Metrics
</a>



      
        
        



<a  title="API" href="https://themotion.github.io/ladder/operating/api/">
	
	API
</a>



      
        
        



<a  title="Extending Ladder" href="https://themotion.github.io/ladder/operating/extending/">
	
	Extending Ladder
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Community</span>
    <ul>
      
        
        



<a  title="Communication channels" href="https://themotion.github.io/ladder/community/mailing-list/">
	
	Communication channels
</a>



      
    </ul>
  
</li>



<li>
  
    



<a  title="License" href="https://github.com/themotion/ladder/blob/master/LICENSE">
	
	License
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/themotionvideo" target="_blank" title="@themotionvideo on Twitter">
              @themotionvideo on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/themotion" target="_blank" title="@themotion on GitHub">
              @themotion on GitHub
            </a>
          </li>
          

          
          <li>
            <a href="mailto:tech-honey-badger@themotion.com" title="Email of tech-honey-badger@themotion.com">
              Contact via email
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Gatherers </h1>

			

<h2 id="dummy">Dummy</h2>

<p>Dummy gatherer always will return a constant quantity</p>

<h3 id="name">Name</h3>

<p><code>dummy</code></p>

<h3 id="options">Options</h3>

<ul>
<li><code>quantity</code>: The quantity to return always</li>
</ul>

<h3 id="example">Example</h3>

<pre><code class="language-yaml">gather:
  kind: dummy
  config:
    quantity: 0
</code></pre>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only used for testing</p>
</div>

<h2 id="random">Random</h2>

<p>Random gatherer will return a random number between a max and min bounds</p>

<h3 id="name-1">Name</h3>

<p><code>random</code></p>

<h3 id="options-1">Options</h3>

<ul>
<li><code>max_limit</code>: The max limit of the random (not included)</li>
<li><code>min_limit</code>: The min limit of the random (included)</li>
</ul>

<h3 id="example-1">Example</h3>

<pre><code class="language-yaml">gather:
  kind: random
  config:
    max_limit: 10
    min_limit: 0
</code></pre>

<h2 id="sqs-property">SQS property</h2>

<p>SQS gatherer will return the quantity of the number of messages of a queue, this
number can be one of the available SQS prperties</p>

<h3 id="name-2">Name</h3>

<p><code>aws_sqs</code></p>

<h3 id="options-2">Options</h3>

<ul>
<li><code>queue_url</code>: The SQS queue URL</li>
<li><code>queue_property</code>: The property to get the message number, can be one of these 3:

<ul>
<li><code>ApproximateNumberOfMessages</code></li>
<li><code>ApproximateNumberOfMessagesNotVisible</code></li>
<li><code>ApproximateNumberOfMessagesDelayed</code></li>
</ul></li>
<li><code>aws_region</code>: The region of AWS where the SQS queue lives</li>
</ul>

<h3 id="example-2">Example</h3>

<pre><code class="language-yaml">gather:
  kind: aws_sqs
  config:
    queue_url: &quot;https://sqs.us-west-2.amazonaws.com/016386521566/slok-render-jobs&quot;
    queue_property: &quot;ApproximateNumberOfMessages&quot;
    aws_region: &quot;us-west-2&quot;
</code></pre>

<h2 id="cloudwatch-metric">Cloudwatch metric</h2>

<p>Cloudwatchmetric gatherer will return a current metric of a given query for the
last minute aggregation, this let us know curren values (approx.) about AWS metrics.</p>

<h3 id="name-3">Name</h3>

<p><code>aws_cloudwatch_metric</code></p>

<h3 id="options-3">Options</h3>

<ul>
<li><code>aws_region</code>: The region of AWS where the cloudwatch metrics</li>
<li><code>metric_name</code>: The name of the metric(<code>CPUReservation</code>, <code>CPUCreditBalance</code>, <code>DiskWriteBytes</code>&hellip;)</li>
<li><code>namespace</code>: The namespace of the metric (<code>AWS/ELB</code>, <code>AWS/EC2</code>&hellip;)</li>
<li><code>statistic</code>: The statistic type of the metric. Check them at:     <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/cloudwatch_concepts.html#Statistic">https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/cloudwatch_concepts.html#Statistic</a></li>
<li><code>unit</code>: The unit type of the metric, Check them at:   <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/cloudwatch_concepts.html#Unit">https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/cloudwatch_concepts.html#Unit</a></li>
<li><code>offset</code>: 0 or negative time duration to apply to the metrics query, for example <code>-30s</code> will get the metrics from -1&rsquo;30&rdquo; to -30&rdquo; metrics from now</li>
<li><code>dimensions</code>: dimensions are like prometheus labels, is a list of dicts having <code>name</code> and <code>value</code> with this the metric wil be filtered</li>
</ul>

<h3 id="example-3">Example</h3>

<pre><code class="language-yaml">gather:
  kind: aws_cloudwatch_metric
  config:
    aws_region: &quot;us-west-2&quot;
    metric_name: &quot;CPUReservation&quot;
    namespace: &quot;AWS/ECS&quot;
    statistic: &quot;Maximum&quot;
    unit: &quot;Percent&quot;
    offset: &quot;-30s&quot;
    dimensions:
    - name: &quot;ClusterName&quot;
      value: &quot;slok-ECSCluster1-15OBYPKBNXIO6&quot;
</code></pre>

<h2 id="prometheus-metric">Prometheus metric</h2>

<p>Prometheus metric gatherer is one of the most powerful gatherers, not because of the gatherer itself, but for
the amazing Prometheus query API. This gatherer should work with single sample vectors, other type of results
from Prometheus will error, for example a vector with length greater than 1 or a Matrix result.</p>

<p>Prometheus gatherer accepts different prometheus so it can fallback to a different prometheus to get the metric.
<a href="https://prometheus.io/docs/introduction/faq/#can-prometheus-be-made-highly-available?">HA Prometheus</a> infrastructure is usually made by 2 equal prometheis that are independent one each other</p>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should query precalculated metrics (recording rules), this will speed up the query and will be more
readable</p>
</div>

<h3 id="name-4">Name</h3>

<p><code>prometheus_metric</code></p>

<h3 id="options-4">Options</h3>

<ul>
<li><code>addresses</code>: The addresses of the prometheus endpoint</li>
<li><code>query</code>: The query that will be send to prometheus</li>
</ul>

<h3 id="example-4">Example</h3>

<pre><code class="language-yaml">gather:
  kind: prometheus_metric
  config:
    addresses:
      - http://prometheus.prod.bi.themotion.lan
      - http://prometheus2.prod.bi.themotion.lan
      - http://prometheus3.prod.bi.themotion.lan
    query: max(service:container_memory_usage:percent{service=&quot;prometheus&quot;})
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the BSD 3-clause &#39;New&#39; or &#39;Revised&#39; license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://themotion.github.io/ladder/blocks/arrangers/" title="Arrangers">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Arrangers
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://themotion.github.io/ladder/concepts/blocks/" title="Blocks">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Blocks
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = 'https:\/\/themotion.github.io\/ladder\/';
      var repo_id  = 'themotion\/ladder';
    
    </script>

    <script src="https://themotion.github.io/ladder/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;
            
            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }
        

        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
